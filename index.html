<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
    <title>Super-Bario99</title>
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <div id="game-container">
        <canvas id="game-canvas" width="800" height="450"></canvas>
        <div id="score-display">Pontos: 0</div>
        <div id="level-display">Fase: 1</div>
        <div id="best-display">Recorde: 0</div>
        <div id="powerup-display" aria-label="Power-up ativo" style="display:none;">
            <span class="pu-icon" aria-hidden="true"></span>
            <span class="pu-text"></span>
        </div>
        <button id="mute-btn" aria-pressed="false" title="Silenciar">üîä</button>

        <!-- Controles touch (aparece automaticamente em dispositivos m√≥veis) -->
        <div id="touch-controls" aria-hidden="true" style="display: none;">
            <div class="touch-left">
                <button id="touch-left" class="touch-btn" aria-label="Mover para esquerda">‚óÄ</button>
                <button id="touch-right" class="touch-btn" aria-label="Mover para direita">‚ñ∂</button>
            </div>
            <div class="touch-right">
                <button id="touch-jump" class="touch-btn" aria-label="Pular">‚¨Ü</button>
                <button id="touch-attack" class="touch-btn" aria-label="Atacar">X</button>
            </div>
        </div>
    </div>
    
    <div id="menu">
        <div class="menu-card" role="dialog" aria-label="Menu inicial">
            <h1>SUPER-BARIO99</h1>
            <div class="menu-sub">100 fases ‚Ä¢ 11 bosses √©picos ‚Ä¢ 10 vidas</div>
            <div id="daily-challenge" class="menu-sub" style="margin-top:-6px; opacity:0.95; display:none;"></div>
            <div class="menu-actions" aria-label="A√ß√µes do menu">
                <button id="continue-btn" style="display: none;">CONTINUAR</button>
                <button id="start-btn">NOVO JOGO</button>
                <button id="free-mode-btn">MODO LIVRE</button>
                <button id="settings-btn">OP√á√ïES</button>
                <button id="instructions-btn">INSTRU√á√ïES</button>
            </div>
        </div>
    </div>

    <div id="settings" style="display: none;">
        <h2>OP√á√ïES</h2>
        <div class="settings-grid" role="group" aria-label="Configura√ß√µes">
            <label>
                Classe do personagem
                <select id="opt-class" aria-label="Selecionar classe">
                    <option value="bario">Bario (equilibrado)</option>
                    <option value="ninja">Ninja (pulo alto + invisibilidade)</option>
                    <option value="engineer">Engenheiro (repara plataformas)</option>
                    <option value="mage">Mago (cria plataforma tempor√°ria)</option>
                </select>
            </label>

            <label>
                Paleta
                <select id="opt-palette" aria-label="Selecionar paleta">
                    <option value="default">Padr√£o</option>
                    <option value="ocean">Ocean</option>
                    <option value="neon">Neon</option>
                    <option value="retro">Retr√¥</option>
                </select>
            </label>

            <label>
                Chap√©u
                <select id="opt-hat" aria-label="Selecionar chap√©u">
                    <option value="none">Nenhum</option>
                    <option value="cap">Bon√©</option>
                    <option value="beanie">Gorro</option>
                    <option value="crown">Coroa</option>
                </select>
            </label>

            <label class="settings-row">
                <input id="opt-lowpower" type="checkbox" />
                Modo baixo consumo (menos efeitos)
            </label>

            <label class="settings-row">
                <input id="opt-reduceflashes" type="checkbox" />
                Acessibilidade: reduzir flashes/glitch
            </label>

            <label class="settings-row">
                <input id="opt-gamepad" type="checkbox" checked />
                Ativar controle (Gamepad)
            </label>
        </div>

        <p style="max-width:520px; opacity:0.92; font-size:18px;">
            Atalhos: <strong>C</strong>=habilidade da classe ‚Ä¢ <strong>Shift</strong>=dash ‚Ä¢ <strong>T</strong>=slow time ‚Ä¢ <strong>P</strong>=foto
        </p>
        <button id="settings-back-btn">VOLTAR</button>
    </div>
    
    <div id="instructions" style="display: none;">
        <h2>COMO JOGAR</h2>
        <p>Setas direcionais para mover</p>
        <p>Espa√ßo para pular</p>
        <p>X para atacar</p>
        <p>Dica: pule e pouse em cima do bloco "?" para liberar power-up</p>
        <p>Meta: Colete moedas e chegue na bandeira!</p>
        <button id="back-btn">VOLTAR</button>
    </div>

    <div id="end-screen" style="display: none;">
        <h2 id="end-title">FIM</h2>
        <p id="end-score">Pontua√ß√£o: 0</p>
        <p id="end-best">Recorde: 0</p>
        <button id="restart-btn">JOGAR NOVAMENTE</button>
        <button id="menu-btn">MENU</button>
    </div>

    <!-- Modo Livre / Criativo -->
    <div id="free-mode" aria-hidden="true" data-panel="left" data-simple="true">
        <div class="fm-header">
            <div class="fm-title">MODO LIVRE</div>
            <button id="free-mode-close" class="fm-close" aria-label="Fechar Modo Livre">VOLTAR</button>
        </div>

        <!-- Abas no mobile -->
        <div class="fm-tabs" role="tablist" aria-label="Abas do Modo Livre">
            <button class="fm-tab" id="fm-tab-config" role="tab" aria-selected="true">Configurar</button>
            <button class="fm-tab" id="fm-tab-preview" role="tab" aria-selected="false">Preview</button>
        </div>

        <div class="fm-body">
            <div class="fm-left" aria-label="Configura√ß√µes do Modo Livre">
                <div class="fm-categories">
                    <div class="fm-section-title">Categorias</div>
                    <div class="fm-grid" aria-label="Categorias">
                        <div class="fm-card" data-scroll="fm-section-stage"><strong>Fases</strong><div>Escolha a fase e o modo de sele√ß√£o.</div></div>
                        <div class="fm-card" data-scroll="fm-section-aesthetic"><strong>Est√©ticas</strong><div>Escolha a identidade visual.</div></div>
                        <div class="fm-card" data-scroll="fm-section-enemies"><strong>Inimigos</strong><div>Controle quantidade e tipos.</div></div>
                        <div class="fm-card" data-scroll="fm-section-diff"><strong>Dificuldade</strong><div>Gravidade e velocidade.</div></div>
                        <div class="fm-card" data-scroll="fm-section-presets"><strong>Presets</strong><div>Relaxante, Cl√°ssico, Dif√≠cil...</div></div>
                        <div class="fm-card" data-scroll="fm-section-save"><strong>Salvar</strong><div>Slots e miniaturas.</div></div>
                        <div class="fm-card" data-scroll="fm-section-share"><strong>Compartilhar</strong><div>Gerar e importar c√≥digo.</div></div>
                        <div class="fm-card" data-scroll="fm-section-play"><strong>Jogar</strong><div>Iniciar com as configs.</div></div>
                        <div class="fm-card"><strong>Acess√≠vel</strong><div>Compat√≠vel com toque e leitor.</div></div>
                    </div>
                </div>

                <div id="fm-section-stage" class="fm-section-title">Sele√ß√£o de Fase</div>
                <label>
                    Modo de sele√ß√£o
                    <select id="fm-stage-mode" aria-label="Modo de sele√ß√£o de fase">
                        <option value="classic">Modo Cl√°ssico (1-100)</option>
                        <option value="random10">Modo Aleat√≥rio (10 fases)</option>
                        <option value="creator">Modo Criador (sequ√™ncia)</option>
                        <option value="challenge">Modo Desafio (por dificuldade)</option>
                    </select>
                </label>
                <label>
                    Fase inicial
                    <select id="fm-stage" aria-label="Selecionar fase inicial"></select>
                </label>

                <div id="fm-section-aesthetic" class="fm-section-title">Est√©tica</div>
                <label>
                    Est√©tica
                    <select id="fm-aesthetic" aria-label="Selecionar est√©tica"></select>
                </label>
                <label>
                    Intensidade do efeito (0-100)
                    <input id="fm-effect" type="range" min="0" max="100" value="80" aria-label="Intensidade dos efeitos" />
                </label>

                <div id="fm-section-enemies" class="fm-section-title">Inimigos</div>
                <label>
                    Quantidade (0-50)
                    <input id="fm-enemy-count" type="range" min="0" max="50" value="14" aria-label="Quantidade de inimigos" />
                </label>
                <label>
                    Comportamento
                    <select id="fm-enemy-behavior" aria-label="Comportamento padr√£o">
                        <option value="random">Aleat√≥rio</option>
                        <option value="aggressive">Agressivo</option>
                        <option value="defensive">Defensivo</option>
                    </select>
                </label>
                <label>
                    Pool de inimigos
                    <select id="fm-enemy-pool" aria-label="Pool de inimigos"></select>
                </label>

                <div id="fm-section-diff" class="fm-section-title">Dificuldade</div>
                <label>
                    Gravidade
                    <select id="fm-gravity" aria-label="Gravidade">
                        <option value="0.6">Baixa</option>
                        <option value="0.8" selected>Normal</option>
                        <option value="1.05">Alta</option>
                        <option value="1.25">M√°xima</option>
                    </select>
                </label>
                <label>
                    Vidas
                    <select id="fm-lives" aria-label="Vidas">
                        <option value="inf">Infinitas</option>
                        <option value="10" selected>10</option>
                        <option value="3">3</option>
                        <option value="1">1</option>
                    </select>
                </label>

                <div id="fm-section-presets" class="fm-section-title">Presets</div>
                <div class="fm-actions">
                    <button id="fm-preset-relax">Modo Relaxante</button>
                    <button id="fm-preset-classic">Modo Cl√°ssico</button>
                    <button id="fm-preset-hard">Modo Dif√≠cil</button>
                    <button id="fm-preset-impossible">Modo Imposs√≠vel</button>
                </div>

                <div id="fm-section-save" class="fm-section-title">Salvar (10 slots)</div>
                <label>
                    Nome do slot
                    <input id="fm-slot-name" type="text" placeholder="Meu setup" aria-label="Nome do setup" />
                </label>
                <label>
                    Slot
                    <select id="fm-slot" aria-label="Slot de salvamento"></select>
                </label>
                <div class="fm-actions">
                    <button id="fm-save">Salvar</button>
                    <button id="fm-load">Carregar</button>
                </div>

                <div id="fm-section-share" class="fm-section-title">Compartilhar</div>
                <label>
                    C√≥digo
                    <input id="fm-share-code" type="text" placeholder="SB99-..." aria-label="C√≥digo de compartilhamento" />
                </label>
                <div class="fm-actions">
                    <button id="fm-generate">Gerar C√≥digo</button>
                    <button id="fm-import">Importar C√≥digo</button>
                </div>

                <div id="fm-section-play" class="fm-section-title">Jogar</div>
                <div class="fm-actions">
                    <button id="fm-play">JOGAR</button>
                </div>
            </div>

            <div class="fm-right" aria-label="Preview do Modo Livre">
                <div class="fm-section-title">Pr√©-visualiza√ß√£o</div>
                <canvas id="preview-canvas" class="fm-preview" width="300" height="180" aria-label="Canvas de preview"></canvas>
                <div style="margin-top: 10px; font-size: 14px; opacity: 0.9;">
                    O preview atualiza conforme voc√™ muda as op√ß√µes.
                </div>
            </div>
        </div>
    </div>

        <!-- V2 (modular, sem ES Modules) -->
        <script src="js/core/globals.js"></script>
        <script src="js/themes/theme-manager.js"></script>
        <script src="js/core/audio-manager.js"></script>
        <script src="js/ai/difficulty-system.js"></script>
        <script src="js/ai/pathfinding.js"></script>
        <script src="js/levels/levels.js"></script>
        <script src="js/levels/secret-phase-system.js"></script>
        <script src="js/levels/special-phases-config.js"></script>
        <script src="js/powerups/gear-renderer.js"></script>
        <script src="js/powerups/powerup-system.js"></script>
        <script src="js/powerups/question-blocks.js"></script>
        <script src="js/powerups/projectiles.js"></script>
        <script src="js/environment/weather-system.js"></script>
        <script src="js/environment/scenery-builder.js"></script>
        <script src="js/environment/dynamic-backgrounds.js"></script>
        <script src="js/enemies/theme-enemy-factory.js"></script>
        <script src="js/enemies/traditional/ninja.js"></script>
        <script src="js/enemies/traditional/yokai.js"></script>
        <script src="js/enemies/traditional/samurai.js"></script>
        <script src="js/enemies/traditional/tanuki.js"></script>
        <script src="js/enemies/traditional/kitsune.js"></script>
        <script src="js/enemies/traditional/drone.js"></script>
        <script src="js/enemies/themed/jellyfish.js"></script>
        <script src="js/enemies/themed/shark.js"></script>
        <script src="js/enemies/themed/oni-mask.js"></script>
        <script src="js/enemies/themed/monkey.js"></script>
        <script src="js/enemies/bosses/boss-registry.js"></script>
        <script src="js/enemies/bosses/theme-boss.js"></script>
        <script src="js/core/player.js"></script>
        <script src="js/npcs/lore-generator.js"></script>
        <script src="js/npcs/human-npc.js"></script>
        <script src="js/modes/free-mode.js"></script>
        <script src="js/core/game.js"></script>
        <script>
            // Boot v2
            (function () {
                const game = new SuperBario99.GameV2();
                SuperBario99.__game = game; // refer√™ncia global (usada pelo Modo Livre)
                game.init();
            })();
        </script>
</body>
</html>